/* Form Component Styles */

/* Base input styles - Mobile-optimized */
input {
  background-color: var(--color-surface);
  border: 1px solid var(--color-border);
  color: var(--color-text-main);
  border-radius: var(--radius-md);
  padding: var(--spacing-md) var(--spacing-lg);
  transition: border-color var(--transition-fast);
  outline: none;
  font-family: var(--font-body);
  font-size: var(--font-size-base);

  /* Touch-friendly sizing */
  min-height: var(--touch-target-min);

  /* Mobile input optimizations */
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;

  /* Prevent zoom on focus (iOS) */
  font-size: max(16px, var(--font-size-base));

  /* Touch optimizations */
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

input:hover {
  border-color: var(--color-text-muted);
}

input:focus {
  border-color: var(--color-primary);
  box-shadow: 0 0 0 3px hsla(var(--primary-hue), var(--primary-sat), var(--primary-light), 0.1);
}

/* Specific input types for mobile */
input[type="date"] {
  color-scheme: dark;
  min-height: var(--touch-target-min);
}

/* Remove Arrows from Number Input */
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type=number] {
  -moz-appearance: textfield;
  appearance: textfield;
}

/* Select elements - Touch-optimized */
select.input-select {
  min-height: var(--touch-target-min);
  padding: var(--spacing-md);
  font-size: max(16px, var(--font-size-base));
  /* Prevent iOS zoom */
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  background-color: var(--color-surface);
  border: 1px solid var(--color-border);
  color: var(--color-text-main);
  border-radius: var(--radius-md);
  font-family: var(--font-body);
  transition: border-color var(--transition-fast);
  outline: none;
}

/* Enhanced focus states for touch */
select.input-select:focus {
  border-color: var(--color-primary);
  box-shadow: 0 0 0 3px hsla(var(--primary-hue), var(--primary-sat), var(--primary-light), 0.1);
  outline: none;
}

/* Mobile Form Styles */
.mobile-form-input,
.mobile-form-select {
  width: 100%;
  min-height: var(--touch-target-min);
  font-size: 16px;
  /* Prevent zoom on iOS */
  padding: var(--spacing-md);
  border-radius: var(--radius-md);
  border: 1px solid var(--color-border);
  background: var(--color-surface);
  color: var(--color-text-main);
  transition: all var(--transition-fast);
  font-family: var(--font-body);
  outline: none;
}

.mobile-form-input:focus,
.mobile-form-select:focus {
  border-color: var(--color-primary);
  box-shadow: 0 0 0 3px hsla(var(--primary-hue), var(--primary-sat), var(--primary-light), 0.1);
  outline: none;
}

/* Mobile add account form */
.mobile-add-account-form {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: var(--spacing-lg);
  margin-top: var(--spacing-md);
}

/* Mobile Date Range Form */
.mobile-date-range-form {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: var(--spacing-lg);
}

.mobile-date-input-wrapper {
  width: 100%;
}

.mobile-date-input-wrapper label {
  display: block;
  font-size: var(--font-size-sm);
  font-weight: 500;
  color: var(--color-text-muted);
  margin-bottom: var(--spacing-xs);
}

/* Transaction form mobile optimizations */
.transaction-form.mobile-optimized {
  /* Optimize for thumb reach on mobile */
  width: 100%;

  /* Ensure form takes full width */
  @media (max-width: 767px) {
    min-height: calc(var(--visual-viewport-height) - 120px);
    justify-content: flex-end;
  }
}

/* Ensure inputs in transaction form are always full width */
.transaction-form input,
.transaction-form select,
.transaction-form .input-select {
  width: 100% !important;
  /* Force full width to match container */
  max-width: 100%;
  box-sizing: border-box;
}

/* Category chip container - Scrollable grid layout */
.category-chip-container {
  /* Enhanced scrollable grid for thumb-friendly navigation */
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: var(--spacing-md);
  max-height: 40vh;
  overflow-y: auto;
  overflow-x: hidden;
  padding: var(--spacing-sm);
  border-radius: var(--radius-md);
  background: var(--color-surface);
  border: 1px solid var(--color-border);

  /* Enhanced mobile scrolling */
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;

  /* Optimize for mobile */
  @media (max-width: 767px) {
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    max-height: 35vh;
    gap: var(--spacing-sm);
  }
}

/* Category chips - Touch-optimized for thumb navigation */
.category-chip {
  /* Enhanced touch target size for better thumb reach */
  min-height: 56px;
  min-width: var(--touch-target-min);

  /* Grid layout handles spacing */
  margin: 0;

  /* Flexible sizing for content */
  flex: 0 0 auto;

  /* Enhanced touch feedback */
  position: relative;
  overflow: hidden;

  /* Better visual hierarchy */
  font-weight: 500;
  border-radius: var(--radius-lg);

  /* Improved touch interaction */
  cursor: pointer;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  color: var(--color-text-main);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--spacing-md);
  transition: all var(--transition-fast);
}

.category-chip::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  transform: translate(-50%, -50%);
  transition: width 0.3s ease, height 0.3s ease;
  pointer-events: none;
}

.category-chip:active::after {
  width: 200px;
  height: 200px;
}

/* Enhanced category chip spacing in grid */
.category-chip-container .category-chip {
  margin: 0;
  /* Grid handles spacing */
  width: 100%;
  justify-self: stretch;
}

/* Keyboard-aware viewport adjustments */
body.keyboard-visible {
  /* Adjust layout when virtual keyboard is visible */
  --visual-viewport-height: var(--visual-viewport-height, 100vh);
}

body.keyboard-visible #app {
  /* Ensure content remains accessible above keyboard */
  min-height: var(--visual-viewport-height);
  padding-bottom: 0;
  /* Let individual components handle their spacing */
}

body.keyboard-visible .transaction-form {
  /* Ensure form content is accessible above keyboard */
  margin-bottom: 0;
  justify-content: flex-start !important;
  /* Move content to top when keyboard is open */
  padding-top: var(--spacing-md);
}

/* Collapse category list when keyboard is open to ensure visibility */
body.keyboard-visible .category-chip-container {
  max-height: 120px;
  /* Small scrollable area */
  flex-shrink: 1;
  /* Allow shrinking */
  min-height: 0;
}

/* Ensure thumb reach container adapts */
body.keyboard-visible .thumb-reach-container {
  min-height: 0 !important;
  justify-content: flex-start !important;
  padding-bottom: var(--spacing-sm) !important;
}

/* Enhanced input focus states for mobile keyboard interaction */
body.keyboard-visible input:focus,
body.keyboard-visible select:focus {
  /* Stronger focus indication when keyboard is active */
  border-color: var(--color-primary);
  box-shadow: 0 0 0 4px hsla(var(--primary-hue), var(--primary-sat), var(--primary-light), 0.15);
  transform: scale(1.02);
  transition: all var(--transition-fast);
}

/* Responsive adjustments for different mobile screen sizes */
@media (max-width: 480px) {
  .category-chip-container {
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: var(--spacing-xs);
    max-height: 30vh;
  }

  .category-chip {
    min-height: 48px;
    font-size: var(--font-size-sm);
    padding: var(--spacing-md);
  }
}

/* Landscape orientation optimizations */
@media (orientation: landscape) and (max-height: 500px) {
  .category-chip-container {
    max-height: 25vh;
    grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
  }

  .transaction-form.mobile-optimized {
    min-height: calc(var(--visual-viewport-height) - 80px);
  }
}

/* Responsive adjustments for forms */
@media (min-width: 768px) {
  .mobile-date-range-form {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-lg);
    align-items: end;
  }

  .mobile-date-input-wrapper:last-child {
    grid-column: span 2;
  }
}

/* Mobile-friendly focus states */
@media (max-width: 767px) {
  input:focus {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
  }
}

/* iOS specific fixes */
@supports (-webkit-touch-callout: none) {

  /* iOS Safari specific styles */
  input {
    /* Fix iOS input styling */
    -webkit-appearance: none;
    appearance: none;
    border-radius: var(--radius-md);
  }

  /* Prevent iOS zoom on input focus */
  input[type="text"],
  input[type="number"],
  input[type="email"],
  input[type="tel"],
  input[type="date"],
  select,
  textarea {
    font-size: 16px !important;
  }
}

/* Android specific fixes */
@media screen and (-webkit-min-device-pixel-ratio: 0) and (min-resolution: .001dpcm) {

  /* Android Chrome specific styles */
  input:focus {
    /* Prevent Android zoom */
    font-size: 16px;
  }
}

/* Dark mode optimizations for mobile */
@media (prefers-color-scheme: dark) {

  /* Already using dark theme, but ensure mobile-specific adjustments */
  input[type="date"]::-webkit-calendar-picker-indicator {
    filter: invert(1);
  }
}